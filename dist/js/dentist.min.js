import Visit from"./visit.js";import{dentistCollection,fetchJSON}from"./script.min.js";export default class VisitDentist extends Visit{constructor(t,s,i,e,n,a,o){super(t,s,i,e,n,a),this.lastVisit=o,this.collection=dentistCollection,this.doctor="dentist"}renderSpecifics(){this.showMoreList=document.createElement("ul"),this.moreList.appendChild(this.showMoreList),this.showMoreList.innerHTML=` \n            <li class="showMore-list">Purpose: <span>${this.purpose}</span></li>\n            <li class="showMore-list">Description: <span>${this.description}</span></li>\n            <li class="showMore-list">Urgency: <span class="js-urgency">${this.urgency}</span></li>\n            <li class="showMore-list">Last Visit: <span>${this.lastVisit}</span></li>\n        `,this.showMore()}startEdit(){this.visitCard.innerHTML=`\n            <span class="delete-modal"><img width="35px"\n            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXlY9LX-DeiAsGRMtm3qORPvue0530zBDYrQ&usqp=CAU"\n            alt="img"></span>\n            <ul class="visit-list">\n                <li>Name & Surname: <input class="js-edit-fullName" value="${this.fullName}"/></li>\n                <li>Purpose: <input class="js-edit-purpose" value="${this.purpose}"/></li>\n                <li>Description: <input class="js-edit-description" value="${this.description}"/></li>\n                <li>Urgency: \n                    <select name="select" class="js-edit-urgency">\n                        <option value="regular">Regular</option>\n                        <option value="priority">Priority</option>\n                        <option value="urgent">Urgent</option>\n                    </select>\n                </li>\n                <li>Last Visit: <input class="js-edit-last-visit" value="${this.lastVisit}"/></li>\n                <div class="visit-buttons js-save-edit-btn">\n                <a class="create-visit"><span class="logo-name">Save</span></a></div>\n            </ul>`,this.urgencySelected=this.visitCard.querySelector(".js-edit-urgency"),this.urgencySelected.addEventListener("change",this.urgencySelecting.bind(this)),this.saveBtn=this.visitCard.querySelector(".js-save-edit-btn"),this.saveBtn.addEventListener("click",this.saveChanges.bind(this)),this.removeBtn=this.visitCard.querySelector(".delete-modal"),this.removeBtn.addEventListener("click",this.delete.bind(this))}async saveChanges(){const t=this.visitCard.querySelector(".js-edit-purpose").value,s=this.visitCard.querySelector(".js-edit-description").value,i=this.visitCard.querySelector(".js-edit-urgency").value,e=this.visitCard.querySelector(".js-edit-fullName").value,n=this.visitCard.querySelector(".js-edit-last-visit").value,a=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/dentist/${this.id}`,{method:"PATCH",body:JSON.stringify({purpose:t,description:s,urgency:i,fullName:e,lastVisit:n}),headers:{"Content-type":"application/json"}});this.purpose=a.purpose,this.description=a.description,this.urgency=a.urgency,this.fullName=a.fullName,this.lastVisit=a.lastVisit,this.setContent()}async checkStatus(){if(this.visitCard.querySelector(".checkbox").checked){const t=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/dentist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"done"}),headers:{"Content-type":"application/json"}});this.status=t.status}else{const t=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/dentist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"open"}),headers:{"Content-type":"application/json"}});this.status=t.status}}}