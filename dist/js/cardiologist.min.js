import Visit from"./visit.js";import{cardiologistCollection,fetchJSON}from"./script.min.js";export default class VisitCardiologist extends Visit{constructor(s,e,i,t,n,l,r,o,a,c){super(s,e,i,t,n,l),this.age=c,this.pressure=r,this.bodyWeightIndex=o,this.illnessHistory=a,this.collection=cardiologistCollection,this.doctor="cardiologist"}renderSpecifics(){this.showMoreList=document.createElement("ul"),this.moreList.appendChild(this.showMoreList),this.showMoreList.innerHTML=` \n            <li class="showMore-list">Purpose:<span> ${this.purpose}</span> </li>\n            <li class="showMore-list">Description: <span>${this.description}</span></li>\n            <li class="showMore-list">Urgency: <span class="js-urgency">${this.urgency}</span></li>\n            <li class="showMore-list">Age: <span>${this.age}</span></li>\n            <li class="showMore-list">Pressure: <span>${this.pressure}</span></li>\n            <li class="showMore-list">Body Mass Index: <span>${this.bodyWeightIndex}</span></li>\n            <li class="showMore-list">History of Illness: <span>${this.illnessHistory}</span></li>\n        `,this.showMore()}startEdit(){this.visitCard.innerHTML=`\n        <span class="delete-modal"><img width="35px"\n        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXlY9LX-DeiAsGRMtm3qORPvue0530zBDYrQ&usqp=CAU"\n        alt="img"></span>\n        <ul class="visit-list">\n            <li>Name & Surname: <input class="js-edit-fullName" value="${this.fullName}"/></li>\n            <li>Purpose: <input class="js-edit-purpose" value="${this.purpose}"/></li>\n            <li>Description: <input class="js-edit-description" value="${this.description}"/></li>\n            <li>Urgency: \n                <select name="select" class="js-edit-urgency">\n                    <option value="regular">Regular</option>\n                    <option value="priority">Priority</option>\n                    <option value="urgent">Urgent</option>\n                </select>\n            </li>\n            <li>Age: <input class="js-edit-age" value="${this.age}"/></li>\n            <li>Pressure: <input class="js-edit-pressure" value="${this.pressure}"/></li>\n            <li>Body Weight: <input class="js-edit-body-weight-index" value="${this.bodyWeightIndex}"/></li>\n            <li>Illnesses: <input class="js-edit-illness-history" value="${this.illnessHistory}"/></li>\n            <div class="visit-buttons js-save-edit-btn">\n            <a class="create-visit"><span class="logo-name">Save</span></a></div>\n        </ul>`,this.urgencySelected=this.visitCard.querySelector(".js-edit-urgency"),this.urgencySelected.addEventListener("change",this.urgencySelecting.bind(this)),this.saveBtn=this.visitCard.querySelector(".js-save-edit-btn"),this.saveBtn.addEventListener("click",this.saveChanges.bind(this)),this.removeBtn=this.visitCard.querySelector(".delete-modal"),this.removeBtn.addEventListener("click",this.delete.bind(this))}async saveChanges(){const s=this.visitCard.querySelector(".js-edit-purpose").value,e=this.visitCard.querySelector(".js-edit-description").value,i=this.visitCard.querySelector(".js-edit-urgency").value,t=this.visitCard.querySelector(".js-edit-fullName").value,n=this.visitCard.querySelector(".js-edit-age").value,l=this.visitCard.querySelector(".js-edit-pressure").value,r=this.visitCard.querySelector(".js-edit-body-weight-index").value,o=this.visitCard.querySelector(".js-edit-illness-history").value,a=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/cardiologist/${this.id}`,{method:"PATCH",body:JSON.stringify({purpose:s,description:e,urgency:i,fullName:t,age:n,pressure:l,bodyWeightIndex:r,illnessHistory:o}),headers:{"Content-type":"application/json"}});this.purpose=a.purpose,this.description=a.description,this.urgency=a.urgency,this.fullName=a.fullName,this.age=a.age,this.pressure=a.pressure,this.bodyWeightIndex=a.bodyWeightIndex,this.illnessHistory=a.illnessHistory,this.setContent()}async checkStatus(){if(this.visitCard.querySelector(".checkbox").checked){const s=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/cardiologist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"done"}),headers:{"Content-type":"application/json"}});this.status=s.status}else{const s=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/cardiologist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"open"}),headers:{"Content-type":"application/json"}});this.status=s.status}}}