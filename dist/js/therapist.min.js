import Visit from"./visit.js";import{therapistCollection,fetchJSON}from"./script.min.js";export default class VisitTherapist extends Visit{constructor(t,e,s,i,n,a,r){super(t,e,s,i,n,a),this.age=r,this.collection=therapistCollection,this.doctor="therapist"}renderSpecifics(){this.showMoreList=document.createElement("ul"),this.moreList.appendChild(this.showMoreList),this.showMoreList.innerHTML=` \n            <li class="showMore-list">Purpose: <span>${this.purpose}</span></li>\n            <li class="showMore-list">Description: <span>${this.description}</span></li>\n            <li class="showMore-list">Urgency: <span class="js-urgency">${this.urgency}</span></li>\n            <li class="showMore-list">Age: <span>${this.age}</span></li>\n        `,this.showMore()}startEdit(){this.visitCard.innerHTML=`\n        <span class="delete-modal"><img width="35px"\n        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXlY9LX-DeiAsGRMtm3qORPvue0530zBDYrQ&usqp=CAU"\n        alt="img"></span>\n        <ul class="visit-list">\n            <li>Name & Surname: <input class="js-edit-fullName" value="${this.fullName}"/></li>\n            <li>Purpose: <input class="js-edit-purpose" value="${this.purpose}"/></li>\n            <li>Description: <input class="js-edit-description" value="${this.description}"/></li>\n            <li>Urgency: \n                <select name="select" class="js-edit-urgency">\n                    <option value="regular">Regular</option>\n                    <option value="priority">Priority</option>\n                    <option value="urgent">Urgent</option>\n                </select>\n            </li>\n            <li>Age: <input class="js-edit-age" value="${this.age}"/></li>\n            <div class="visit-buttons js-save-edit-btn">\n            <a class="create-visit"><span class="logo-name">Save</span></a></div>\n        </ul>`,this.urgencySelected=this.visitCard.querySelector(".js-edit-urgency"),this.urgencySelected.addEventListener("change",this.urgencySelecting.bind(this)),this.saveBtn=this.visitCard.querySelector(".js-save-edit-btn"),this.saveBtn.addEventListener("click",this.saveChanges.bind(this)),this.removeBtn=this.visitCard.querySelector(".delete-modal"),this.removeBtn.addEventListener("click",this.delete.bind(this))}async saveChanges(){const t=this.visitCard.querySelector(".js-edit-fullName").value,e=this.visitCard.querySelector(".js-edit-purpose").value,s=this.visitCard.querySelector(".js-edit-description").value,i=this.visitCard.querySelector(".js-edit-urgency").value,n=this.visitCard.querySelector(".js-edit-age").value,a=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/therapist/${this.id}`,{method:"PATCH",body:JSON.stringify({fullName:t,purpose:e,description:s,urgency:i,age:n}),headers:{"Content-type":"application/json"}});this.fullName=a.fullName,this.purpose=a.purpose,this.description=a.description,this.urgency=a.urgency,this.age=a.age,this.setContent()}async checkStatus(){if(this.visitCard.querySelector(".checkbox").checked){const t=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/therapist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"done"}),headers:{"Content-type":"application/json"}});this.status=t.status}else{const t=await fetchJSON(`https://frozen-mountain-86271.herokuapp.com/therapist/${this.id}`,{method:"PATCH",body:JSON.stringify({status:"open"}),headers:{"Content-type":"application/json"}});this.status=t.status}}}